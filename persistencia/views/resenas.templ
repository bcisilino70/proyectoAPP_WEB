package views

import "proyectoAPP_WEB/persistencia/db/sqlc"
import "strconv"
import "fmt" 

templ MisResenas(resenas []db.ListResenasRow) {
    <div id="mis-resenas-wrapper" class="grid-item">
        <h2>Mis Rese√±as</h2>
        
        if len(resenas) == 0 {
            <div id="mis-resenas" class="empty-state">
                Todavia no cargaste resenas.
            </div>
        } else {
            <div id="mis-resenas">
                for _, resena := range resenas {
                    <div class="resena-item">
                        <h3>{ resena.Titulo }</h3>
                        <p>{ resena.Descripcion }</p>
                        <p>Nota: { strconv.Itoa(int(resena.Nota)) }/5</p>
                        <small>Fecha: { resena.Fecha.Format("02-01-2006") }</small>

                        <div class="resena-acciones">
                            // --- HTMX ---
                            // 1. hx-delete: Usamos DELETE y URL con ID (/resenas/{id}) porque el delete necesita el ID de la resena y en el handler obtenemos el del cliente
                            // 2. hx-target: "closest .resena-item" busca hacia arriba el padre contenedor
                            // 3. hx-swap: "outerHTML" reemplaza ese padre por la respuesta vacaa (lo borra)
                            <button 
                                hx-delete={ fmt.Sprintf("/resenas/%d", resena.ID) }
                                hx-target="closest .resena-item"
                                hx-swap="outerHTML"
                                class="btn-eliminar">
                                Eliminar
                            </button>
                        </div>
                    </div>
                }
            </div>
        }
    </div>
}